(function(q){var o,g,v,k,c,j,w,e,l;var a,i,h,t,n,u,m;m=navigator.userAgent;q.isOpera=t=window.opera&&opera.buildNumber;q.isWebKit=n=/WebKit/.test(m);q.isOldWebKit=u=n&&!window.getSelection().getRangeAt;q.isIE=i=!n&&!t&&(/MSIE/gi).test(m)&&(/Explorer/gi).test(navigator.appName);q.isGecko=h=!n&&/Gecko/.test(m);q.plugins={};function f(y,x){y=typeof(y);if(!x){return y!="undefined"}return y==x}function d(z,x,y){var A;if(!z){return 0}y=!y?z:y;if(f(z.length)){for(A=0;A<z.length;A++){if(x.call(y,z[A],A,z)===false){return 0}}}else{for(A in z){if(z.hasOwnProperty(A)){if(x.call(y,z[A],A,z)===false){return 0}}}}return 1}function p(y,x){d(x,function(z,A){y[A]=z});return y}p(q,{is:f,each:d,extend:p});q.I18n=l={bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",underline:"Underline (Ctrl+U)",strike:"Striketrough",ul:"Insert unordered list",ol:"Insert ordered list",indent:"Indent",outdent:"Outdent",left:"Align left",center:"Align center",right:"Align right",style:"Font style",removeformat:"Remove format",increasefontsize:"Increase text size",decreasefontsize:"Decrease text size"};q.DOMUtils=o=function(y){this.files=[];try{y.execCommand("BackgroundImageCache",0,1)}catch(x){}p(this,{get:function(z){return z&&(!z.nodeType&&!z.location?y.getElementById(z):z)},add:function(D,E,z,B){var A=this,C;C=y.createElement(E);d(z,function(F,G){A.setAttr(C,G,F)});if(B){if(B.nodeType){C.appendChild(B)}else{C.innerHTML=B}}return D?D.appendChild(C):C},create:function(B,z,A){return this.add(0,B,z,A)},setAttr:function(A,B,z){A=this.get(A);if(!A){return 0}if(B=="style"){A.setAttribute("mce_style",z);A.style.cssText=z}if(B=="class"){A.className=z}if(z!=null&&z!=""){A.setAttribute(B,""+z)}else{A.removeAttribute(B)}return 1},getAttr:function(B,C,A){var z;B=this.get(B);if(!B){return false}if(!f(A)){A=""}if(/^(src|href|style)$/.test(C)){z=this.getAttr(B,"mce_"+C);if(z){return z}}z=B.getAttribute(C,2);if(C=="class"&&!z){z=B.className}if(C=="style"&&!z){z=B.style.cssText}else{if(!z){z=B.attributes[C];z=z&&f(z.nodeValue)?z.nodeValue:z}}if(n&&C=="class"&&z){z=z.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}return(z&&z!="")?""+z:A},select:function(z,C,A){var B=[];C=this.get(C);C=!C?y:C;d(z.split(","),function(D){d(C.getElementsByTagName(D),function(E){if(!A||A(E)){B.push(E)}})});return B},getPos:function(F,E){var z=0,A=0,C,B,D;F=this.get(F);if(q.isIE&&F){B=F.getBoundingClientRect();D=document;F=D.compatMode=="CSS1Compat"?D.documentElement:D.body;return{x:B.left+(F.scrollLeft||0),y:B.top+(F.scrollTop||0)}}while(F&&F!=E){z+=F.offsetLeft||0;A+=F.offsetTop||0;F=F.offsetParent}return{x:z,y:A}},loadCSS:function(z){var A=this;if(z){d(z.split(","),function(C){var B=-1;d(A.files,function(E,D){if(E==C){B=D;return false}});if(B!=-1){return}A.files.push(C);if(!y.createStyleSheet){A.add(A.select("head")[0],"link",{rel:"stylesheet",href:C})}else{y.createStyleSheet(C)}})}},addClass:function(A,C,z){var B;A=this.get(A);if(!A){return 0}B=this.removeClass(A,C);return A.className=z?C+(B!=""?(" "+B):""):(B!=""?(B+" "):"")+C},removeClass:function(z,A){z=this.get(z);if(!z){return 0}A=z.className.replace(new RegExp("(^|\\s+)"+A+"(\\s+|$)","g")," ");return z.className=A!=" "?A:""},hasClass:function(A,z){A=this.get(A);return new RegExp("\\b"+z+"\\b","g").test(A.className)},getParent:function(B,A,z){while(B){if(B==z){return null}if(A(B)){return B}B=B.parentNode}return null},keep:function(z){if(h){z=z.replace(/<(\/?)strong>|<strong( [^>]+)>/gi,"<$1b$2>");z=z.replace(/<(\/?)em>|<em( [^>]+)>/gi,"<$1i$2>");z=z.replace(/<(\/?)del|<del( [^>]+)>/gi,"<$1strike$2>")}z=z.replace(/ (src|href|style)=\"([^\"]+)\"/gi,' $1="$2" mce_$1="$2"');return z}})};q.DOM=a=new o(document);q.Event=w={events:[],inits:[],unloads:[],add:function(C,D,B,A){var x,y=this,z=y.events;C=a.get(C);x=function(E){E=E||window.event;if(E&&!E.target&&i){E.target=E.srcElement}if(!A){return B(E)}return B.call(A,E)};if(D=="unload"){y.unloads.push(x);return x}if(D=="init"){if(y._init){x()}else{y.inits.push(x)}return x}z.push({obj:C,name:D,func:B,cfunc:x,scope:A});y._add(C,D,x);if(i&&z.length==1){w._add(window,"unload",y._unload,w)}return x},remove:function(A,B,z){var y=this,x=y.events;A=a.get(A);d(x,function(D,C){if(D.obj==A&&D.name==B&&(!z||D.func==z)){x.splice(C,1);y._remove(A,B,D.cfunc);return false}})},cancel:function(x){this.stop(x);return this.prevent(x)},stop:function(x){if(x.stopPropagation){x.stopPropagation()}else{x.cancelBubble=true}return false},prevent:function(x){if(x.preventDefault){x.preventDefault()}else{x.returnValue=false}return false},_unload:function(){var x=w;d(x.events,function(y){x._remove(y.obj,y.name,y.cfunc)});x._remove(window,"unload",x._unload);x.events=[];d(x.unloads,function(y){y()})},_add:function(y,z,x){if(y.attachEvent){y.attachEvent("on"+z,x)}else{if(y.addEventListener){y.addEventListener(z,x,false)}else{y["on"+z]=x}}},_remove:function(y,z,x){if(y.detachEvent){y.detachEvent("on"+z,x)}else{if(y.removeEventListener){y.removeEventListener(z,x,false)}else{y["on"+z]=null}}},_pageInit:function(){var x=w;x._remove(window,"DOMContentLoaded",x._pageInit);x._init=true;d(x.inits,function(y){y()});x.inits=[]},_wait:function(){var x;if(i&&document.location.protocol!="https:"){document.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");a.get("__ie_onload").onreadystatechange=function(){if(this.readyState=="complete"){w._pageInit();a.get("__ie_onload").onreadystatechange=null}}}else{w._add(window,"DOMContentLoaded",w._pageInit,w);if(i||n){x=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(x);w._pageInit()}},10)}}}};q.Dispatcher=j=function(x){var y=[];if(!x){x=this}p(this,{add:function(z,A){y.push({cb:z,scope:!A?x:A});return z},remove:function(z){d(y,function(B,A){if(z==B.cb){y.splice(A,1)}return false});return z},dispatch:function(){var A,z=arguments;d(y,function(B){return A=B.cb.apply(B.scope,z)});return A}})};q.Editor=k=function(E){var B,C,z=this;if(!q.baseURL){d(a.select("script"),function(F){if(/puny_mce/g.test(""+F.src)){q.baseURL=F.src.replace(/^(.+)\/puny_mce.+$/,"$1/")}})}this.settings=B=p({content_css:q.baseURL+"/css/content.css",editor_css:q.baseURL+"/css/editor.css",width:0,height:0,min_width:260,min_height:50,max_width:800,max_height:600,entities:"raw",spellcheck:0,resize:true,plugins:"",styles:[{title:"H1",cls:"h1",cmd:"FormatBlock",val:"<h1>"},{title:"H2",cls:"h2",cmd:"FormatBlock",val:"<h2>"},{title:"H3",cls:"h3",cmd:"FormatBlock",val:"<h3>"},{title:"Pre",cls:"pre",cmd:"FormatBlock",val:"<pre>"},{title:"Times",cls:"times",cmd:"FontName",val:"Times"},{title:"Arial",cls:"arial",cmd:"FontName",val:"Arial"},{title:"Courier",cls:"courier",cmd:"FontName",val:"Courier"}],toolbar:"bold,italic,underline,strike,increasefontsize,decreasefontsize,ul,ol,indent,outdent,left,center,right,style,removeformat"},E);z.tools={bold:{cmd:"Bold",title:l.bold},italic:{cmd:"Italic",title:l.italic},underline:{cmd:"Underline",title:l.underline},strike:{cmd:"Strikethrough",title:l.strike},ul:{cmd:"InsertUnorderedList",title:l.ul},ol:{cmd:"InsertOrderedList",title:l.ol},indent:{cmd:"Indent",title:l.indent},outdent:{cmd:"Outdent",title:l.outdent},left:{cmd:"JustifyLeft",title:l.left},center:{cmd:"JustifyCenter",title:l.center},right:{cmd:"JustifyRight",title:l.right},style:{cmd:"mceStyle",title:l.style},removeformat:{cmd:"RemoveFormat",title:l.removeformat},increasefontsize:{cmd:"IncreaseFontSize",title:l.increasefontsize},decreasefontsize:{cmd:"DecreaseFontSize",title:l.decreasefontsize}};a.loadCSS(B.editor_css);this.commands={mceStyle:function(M,L,K){var H,N=this,O=N.settings,F=O.id,G=a.getPos(K.target),I;if(N.hideMenu){return N.hideMenu()}function J(P){N.hideMenu=null;w.remove(document,"click",J);w.remove(N.getDoc(),"click",J);a.get(F+"_mstyle").style.display="none"}H=a.get(F+"_mstyle");if(!H){H=a.get(F+"_t");H=a.add(document.body,"div",{id:F+"_mstyle","class":"punymce_style punymce"});d(O.styles,function(P){w.add(a.add(H,"a",{href:"#","class":P.cls},P.title),"mousedown",function(Q){J.call(N);N.execCommand(P.cmd,P.ui,P.val);if(t){N.getIfr().focus()}return w.cancel(Q)})})}N.hideMenu=J;w.add(document,"click",J,N);w.add(N.getDoc(),"click",J,N);O=H.style;O.left=G.x+"px";O.top=(G.y+K.target.clientHeight+2)+"px";O.display="block"},FormatBlock:function(G,F,H){if(h&&/<(div|blockquote|code|dt|dd|dl|samp)>/gi.test(F)){F=F.replace(/[^a-z]/gi,"")}z.getDoc().execCommand("FormatBlock",0,F)},CreateLink:function(H,G){var I=z.dom,F="javascript:mox();";z.getDoc().execCommand("CreateLink",0,F);d(I.select("A"),function(J){if(I.getAttr(J,"href")==F){I.setAttr(J,"href",G);I.setAttr(J,"mce_href",G)}})},mceFontSizeDelta:function(H,G){var L=z.getDoc(),F,K,I,J=z.selection;F=parseInt(L.queryCommandValue("FontSize")||3);if(n){d([10,13,16,18,24,32,48],function(N,M){if(F==N){F=M+1;return false}})}if(F+G<=1){return}L.execCommand("FontSize",false,F+G)},IncreaseFontSize:function(){z.execCommand("mceFontSizeDelta",0,1)},DecreaseFontSize:function(){z.execCommand("mceFontSizeDelta",0,-1)},Indent:function(G,F,H){z.getDoc().execCommand("Indent",0,0);if(i){z.dom.getParent(z.selection.getNode(),function(I){if(I.nodeName=="BLOCKQUOTE"){I.dir=I.style.marginRight=""}})}},mceSetClass:function(G,F,I){var H=z.selection;if(f(F,"string")){F={element:"span","class":F}}if(H.isCollapsed()){z.dom.setAttr(H.getNode(),"class",F["class"])}else{H.setContent("<"+F.element+' class="'+F["class"]+'">'+H.getContent()+"</"+F.element+">")}},RemoveFormat:function(G,F,I){var H=z.selection;z.getDoc().execCommand("RemoveFormat",G,F);if(i){F=H.getContent();F=F.replace(/ (class|style)=\"[^\"]+\"/g,"");F=F.replace(/<\/?(font|strong|em|b|i|u|strike)>/g,"");F=F.replace(/<(font|strong|em|b|i|u|strike) [^>]+>/g,"");H.setContent(F)}}};function A(I){var J,H,F,G;J=a.get(B.id+"_c");F=J.clientWidth-2;G=J.clientHeight-2;H=a.get(B.id+"_p");H.style.width=F+"px";H.style.height=G+"px";J.style.display="none";H.style.display="block";z.resize={x:I.screenX,y:I.screenY,w:F,h:G};w.add(document,"mousemove",y,this);w.add(document,"mouseup",D,this);z.onResizeStart.dispatch(z,I,F,G)}function y(J){var H=z.resize,I,F,G;H.dx=J.screenX-H.x;H.dy=J.screenY-H.y;F=Math.max(B.min_width,H.w+H.dx);G=Math.max(B.min_height,H.h+H.dy);F=Math.min(B.max_width,F);G=Math.min(B.max_height,G);I=a.get(B.id+"_p");I.style.width=F+"px";I.style.height=G+"px";return w.cancel(J)}function D(G){var F=z.resize;w.remove(document,"mousemove",y,this);w.remove(document,"mouseup",D,this);a.get(B.id+"_c").style.display="";a.get(B.id+"_p").style.display="none";z.resizeBy(F.dx,F.dy);z.onResizeEnd.dispatch(z,G,F.dx,F.dy)}function x(){var F=a.get(B.id),G=z.getDoc();if(h){z.getDoc().designMode="On"}G.open();G.write('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body id="punymce"></body></html>');G.close();z.dom=C=new o(z.getDoc());C.loadCSS(B.content_css);z.onPreInit.dispatch(z);if(!B.spellcheck){z.getBody().spellcheck=0}w.add(z.getDoc(),"mouseup",z.nodeChanged,z);w.add(z.getDoc(),"keyup",z.nodeChanged,z);w.add(h?z.getDoc():z.getWin(),"focus",function(I){var H;if((H=q.focusEditor)!=null){H.onBlur.dispatch(H,z)}z.onFocus.dispatch(z,H);q.focusEditor=z},this);if(!i){z.getDoc().designMode="On"}else{z.getBody().contentEditable=true}z.setContent(f(F.value)?F.value:F.innerHTML,{load:true});a.get(B.id+"_c").style.display=z.orgDisplay;a.get(B.id).style.display="none";z.onInit.dispatch(z)}p(this,{serializer:new e(z),selection:new c(z),plugins:[]});d(["onPreInit","onInit","onFocus","onBlur","onResizeStart","onResizeEnd","onPreProcess","onPostProcess","onSetContent","onBeforeGetContent","onGetContent","onNodeChange"],function(F){z[F]=new j(z)});p(this,{init:function(){var K=a.get(B.id),M=K.parentNode,O,I,N,L,G,F,J,H=["bold","italic","underline","left","center","right"];d(B.plugins.split(","),function(P){if(P){z.plugins.push(new q.plugins[P](z))}});z.onNodeChange.add(function(){d(H,function(R){var Q;try{Q=z.getDoc().queryCommandState(z.tools[R].cmd)?a.addClass:a.removeClass;Q.call(a,B.id+"_"+R,"active")}catch(P){}})});if(B.entities=="numeric"){z.onGetContent.add(function(P,Q){if(Q.format=="html"){Q.content=Q.content.replace(/[\u007E-\uFFFF]/g,function(R){return"&#"+R.charCodeAt(0)+";"})}})}O=!B.width?K.offsetWidth:B.width;I=!B.height?K.offsetHeight:B.height;z.orgDisplay=K.style.display;K.style.display="none";if(K.form){J=K.form;z._submit=J.submit;J.submit=function(){var Q=a.get(B.id),P=Q.form;z.save();P.submit=z._submit;P.submit()};w.add(0,"unload",function(){var P=a.get(B.id).form;z._submit=z.submit=null});w.add(J,"submit",z.save,z)}N='<div id="'+B.id+'_w" class="punymce"><table id="'+B.id+'_c" class="punymce"><tr class="mceToolbar">';N+='<td id="'+B.id+'_t"></td></tr><tr class="mceBody"><td></div><div id="'+B.id+'_b" class="mceBody">';if(B.resize){N+='<div id="'+B.id+'_r" class="mceResize"></div>'}N+="</td></tr></table>";N+='<div id="'+B.id+'_p" class="mcePlaceholder"></div></div>';if(!K.insertAdjacentHTML){F=K.ownerDocument.createRange();F.setStartBefore(K);M.insertBefore(F.createContextualFragment(N),K)}else{K.insertAdjacentHTML("beforeBegin",N)}G=a.get(B.id+"_t");L=a.add(G,"ul",{id:B.id+"_tb","class":"punymce"});d(B.toolbar.split(","),function(P){var Q=z.tools[P];G=a.add(a.add(L,"li",{id:B.id+"_"+P,"class":P}),"a",{href:"javascript:void(0);","class":P,title:Q.title,tabIndex:-1,onmousedown:"return false;"});w.add(G,"click",function(R){if(!a.hasClass(R.target.parentNode,"disabled")){z.execCommand(Q.cmd,0,0,R)}return w.cancel(R)})});G=a.get(B.id+"_b");G=a.add(G,"iframe",{id:B.id+"_f",src:'javascript:""',frameBorder:"0","class":"punymce",style:"width:"+O+"px;height:"+I+"px"});z.resizeTo(O,I);if(n){w.add(G,"load",x,z);G.src=q.baseURL+"blank.htm"}else{x()}if(B.resize){w.add(B.id+"_r","mousedown",function(P){return A(P,B.id)},this)}L=J=K=G=null},getSize:function(){var F=a.get(B.id+"_f");return{w:F.clientWidth,h:F.clientHeight}},resizeTo:function(F,H){var G=a.get(B.id+"_f").style;F=Math.max(B.min_width,F);H=Math.max(B.min_height,H);F=Math.min(B.max_width,F);H=Math.min(B.max_height,H);z.width=F;z.height=H;G.width=F+"px";G.height=H+"px"},resizeBy:function(F,G){var H=z.getSize();z.resizeTo(H.w+F,H.h+G)},show:function(){a.get(B.id+"_w").style.display="block";a.get(B.id).style.display="none";z.load()},hide:function(){if(i){z.execCommand("SelectAll")}a.get(B.id+"_w").style.display="none";a.get(B.id).style.display=z.orgDisplay;z.save()},load:function(){var F=a.get(B.id);z.setContent(f(F.value)?F.value:F.innerHTML,{load:true})},save:function(){var G=a.get(B.id),F=z.getContent({save:true});if(/TEXTAREA|INPUT/.test(G.nodeName)){G.value=F}else{G.innerHTML=F}},setUseCSS:function(F){var H=z.getDoc(),G;try{H.execCommand("styleWithCSS",0,false)}catch(G){try{H.execCommand("useCSS",0,true)}catch(G){}}},execCommand:function(K,H,G,J){var F=z.commands,I;z.getWin().focus();z.setUseCSS(0);if(F[K]){I=F[K].call(z,H,G,J)}else{I=z.getDoc().execCommand(K,H,G)}if(I!==false){z.nodeChanged()}},getContent:function(G){var F;G=G||{};G.format=G.format||"html";z.onBeforeGetContent.dispatch(this,G);F=z.serializer.serialize(z.getBody(),G);F=F.replace(/^\s*|\s*$/g,"");G.content=F;z.onGetContent.dispatch(this,G);return G.content},setContent:function(F,G){G=G||{};G.content=F;z.onSetContent.dispatch(this,G);F=G.content;F=a.keep(F);z.getBody().innerHTML=F;if(G.format!="raw"){z.setContent(F=z.getContent(G),{format:"raw"})}else{z.getBody().innerHTML=F}return F},getIfr:function(){return a.get(B.id+"_f")},getWin:function(){return z.getIfr().contentWindow},getDoc:function(){return z.getWin().document},getBody:function(){return z.getDoc().body},nodeChanged:function(){z.setUseCSS(0);z.onNodeChange.dispatch(z,z.selection.getNode())}});w.add(window,"init",z.init,this)};q.Selection=c=function(x){var y=this;p(y,{getContent:function(C){var z,A=y.getRng(),B=document.createElement("body");C=C||{};if(y.isCollapsed()){return""}if(A.cloneContents){B.appendChild(A.cloneContents())}else{if(f(A.item)||f(A.htmlText)){B.innerHTML=A.item?A.item(0).outerHTML:A.htmlText}else{B.innerHTML=A.toString()}}if(C.format!="raw"){C.content=z;x.serializer.serialize(B,C);C.content=C.content.replace(/^\s*|\s*$/g,"");x.onGetContent.dispatch(z,C);z=C.content}else{z=B.innerHTML}return z},getText:function(){var A=y.getRng(),z=y.getSel();if(u){return z}return y.isCollapsed()?"":A.text||z.toString()},setContent:function(B,D){var C=y.getRng(),z,E,C,A;D=D||{format:"raw"};B=a.keep(B);if(D.format!="raw"){D.content=B;B=x.onSetContent.dispatch(this,D);B=D.content;z=x.dom.create("body");z.innerHTML=B}if(C.insertNode){C.deleteContents();C.insertNode(C.createContextualFragment(B+'<span id="__caret">_</span>'));E=x.dom.get("__caret");C=x.getDoc().createRange();C.setStartBefore(E);C.setEndBefore(E);A=y.getSel();A.removeAllRanges();A.addRange(C);E.parentNode.removeChild(E)}else{if(C.pasteHTML){C.pasteHTML(B)}else{C.item(0).outerHTML=B}}},select:function(D,C){var B=y.getRng(),A=y.getSel();if(B.moveToElementText){try{B.moveToElementText(D);B.select()}catch(z){}}else{if(A.addRange){C?B.selectNodeContents(D):B.selectNode(D);A.removeAllRanges();A.addRange(B)}else{A.setBaseAndExtent(D,0,D,1)}}return D},isCollapsed:function(){var z=y.getRng();if(z.item){return false}return z.boundingWidth==0||y.getSel().isCollapsed},collapse:function(z){var B=y.getRng(),A=y.getSel();if(B.select){B.collapse(z);B.select()}else{if(z){A.collapseToStart()}else{A.collapseToEnd()}}},getSel:function(){var z=x.getWin();return z.getSelection?z.getSelection():x.getDoc().selection},getRng:function(){var z=y.getSel(),F=x.getDoc(),B,D,E,A;if(!z){return null}try{return z.rangeCount>0?z.getRangeAt(0):(z.createRange?z.createRange():null)}catch(C){return F.body.createTextRange()}},setRng:function(A){var z=y.getSel();z.removeAllRanges();z.addRange(A)},setNode:function(z){y.setContent(x.dom.create("div",null,z).innerHTML)},getNode:function(){var A=y.getRng(),z=y.getSel(),B;if(!i){if(A){B=A.commonAncestorContainer;if(!A.collapsed){if(A.startContainer==A.endContainer){if(A.startOffset-A.endOffset<2){if(A.startContainer.hasChildNodes()){B=A.startContainer.childNodes[A.startOffset]}}}}}return a.getParent(B,function(C){return C.nodeType==1})}return A.item?A.item(0):A.parentElement()}})};q.Serializer=e=function(y){var A,B=0,C;function z(){var F=document.implementation;if(!F||!F.createDocument){try{return new ActiveXObject("MSXML2.DOMDocument")}catch(E){}try{return new ActiveXObject("Microsoft.XmlDom")}catch(E){}}else{return F.createDocument("","",null)}}A=z();this.settings=C=p({valid_nodes:0,invalid_nodes:/(BODY)/,valid_attrs:0,node_filter:0,root_node:0,pi:0,invalid_attrs:/(^mce_|^_moz_|^contenteditable$)/,closed:/(BR|HR|INPUT|META|IMG)/},y.settings.serializer);function D(F){var E=[];F.cloneNode(false).outerHTML.replace(/([a-z0-9\-_]+)=/gi,function(H,G){E.push({specified:1,nodeName:G})});return E}function x(G,J){var K,E,L,I,H,M,F,O,N;if((!C.valid_nodes||C.valid_nodes.test(G.nodeName))&&(!C.invalid_nodes||!C.invalid_nodes.test(G.nodeName))&&(!C.node_filter||C.node_filter(G,J))){switch(G.nodeType){case 1:if(i){if(G.mce_serialized==B){return}G.mce_serialized=B}K=G.hasChildNodes();E=A.createElement(G.nodeName.toLowerCase());F=i?D(G):G.attributes;for(I=F.length-1;I>-1;I--){O=F[I];if(O.specified){M=O.nodeName.toLowerCase();if(C.invalid_attrs&&C.invalid_attrs.test(M)){continue}if(C.valid_attrs&&!C.valid_attrs.test(M)){continue}N=a.getAttr(G,M);if(N!==""){E.setAttribute(M,N)}}}if(!K&&!C.closed.test(G.nodeName)){E.appendChild(A.createTextNode(""))}J=J.appendChild(E);break;case 3:return J.appendChild(A.createTextNode(G.nodeValue));case 8:return J.appendChild(A.createComment(G.nodeValue))}}else{if(G.nodeType==1){K=G.hasChildNodes()}}if(K){L=G.firstChild;while(L){x(L,J);L=L.nextSibling}}}p(this,{serialize:function(G,F){var E;B=""+(parseInt(B)+1);if(A.firstChild){A.removeChild(A.firstChild)}G=F.node=G.cloneNode(1);y.onPreProcess.dispatch(this,F);x(G,A.appendChild(A.createElement("html")));E=A.xml||new XMLSerializer().serializeToString(A);if(!C.pi){E=E.replace(/<\?[^?]+\?>/g,"")}if(!C.root_node){E=E.replace(/<html>|<\/html>/g,"")}F.content=E;y.onPostProcess.dispatch(this,F);return F.content}})};w._wait();window.punymce=q})({});(function(a){a.plugins.ForceBlocks=function(e){var y=a.Event,w,h=this;var o,l,x,u;var d,v,q;o=a.isIE;l=a.isGecko;x=a.isOpera;u=a.isWebKit;d=a.each;v=a.extend;this.settings=q=v({element:"P"},e.settings.forceblocks);e.onPreInit.add(n,h);if(!o){e.onSetContent.add(function(t,z){if(z.format=="html"){z.content=z.content.replace(/<p>[\s\u00a0]+<\/p>/g,"<p><br /></p>")}})}e.onPostProcess.add(function(t,z){z.content=z.content.replace(/<p><\/p>/g,"<p>\u00a0</p>")});function n(){w=e.dom;y.add(e.getDoc(),"keyup",k);e.onSetContent.add(k);e.onBeforeGetContent.add(k);if(!o){e.onPreProcess.add(function(t,z){d(z.node.getElementsByTagName("br"),function(B){var A=B.parentNode;if(A&&A.nodeName=="p"&&(A.childNodes.length==1||A.lastChild==B)){A.replaceChild(t.getDoc().createTextNode("\u00a0"),B)}})});y.add(e.getDoc(),"keypress",function(t){if(t.keyCode==13&&!t.shiftKey){if(!p(t)){return y.cancel(t)}}});if(l){y.add(e.getDoc(),"keydown",function(t){if((t.keyCode==8||t.keyCode==46)&&!t.shiftKey){i(t,t.keyCode==8)}})}}}function c(z){var A,t;A=z.document;t=A.compatMode=="CSS1Compat"?A.documentElement:A.body;return{x:z.pageXOffset||t.scrollLeft,y:z.pageYOffset||t.scrollTop,w:z.innerWidth||t.clientWidth,h:z.innerHeight||t.clientHeight}}function m(D,A,B){var z=e.getDoc().createTreeWalker(D,4,null,false),D,C=-1;while(D=z.nextNode()){C++;if(A==0&&D==B){return C}if(A==1&&C==B){return D}}return -1}function k(){var F=this,R=e.getBody(),O=e.getDoc(),U=e.selection,G=U.getSel(),H=U.getRng(),S=-2,D,M,z,A,P=-16777215;var Q,B,T,L,I,C=R.childNodes,K,J,E;for(K=C.length-1;K>=0;K--){Q=C[K];if(Q.nodeType==3||(!g(Q)&&Q.nodeType!=8)){if(!B){if(Q.nodeType!=3||/[^\s]/g.test(Q.nodeValue)){if(S==-2&&H){if(!o){if(H.startContainer.nodeType==1&&(J=H.startContainer.childNodes[H.startOffset])&&J.nodeType==1){E=J.getAttribute("id");J.setAttribute("id","__mce")}else{if(e.dom.getParent(H.startContainer,function(t){return t===R})){M=H.startOffset;z=H.endOffset;S=m(R,0,H.startContainer);D=m(R,0,H.endContainer)}}}else{A=O.body.createTextRange();A.moveToElementText(R);A.collapse(1);T=A.move("character",P)*-1;A=H.duplicate();A.collapse(1);L=A.move("character",P)*-1;A=H.duplicate();A.collapse(0);I=(A.move("character",P)*-1)-L;S=L-T;D=I}}B=e.dom.create(q.element);B.appendChild(Q.cloneNode(1));Q.parentNode.replaceChild(B,Q)}}else{if(B.hasChildNodes()){B.insertBefore(Q,B.firstChild)}else{B.appendChild(Q)}}}else{B=null}}if(S!=-2){if(!o){B=R.getElementsByTagName(q.element)[0];H=O.createRange();if(S!=-1){H.setStart(m(R,1,S),M)}else{H.setStart(B,0)}if(D!=-1){H.setEnd(m(R,1,D),z)}else{H.setEnd(B,0)}if(G){G.removeAllRanges();G.addRange(H)}}else{try{H=G.createRange();H.moveToElementText(R);H.collapse(1);H.moveStart("character",S);H.moveEnd("character",D);H.select()}catch(N){}}}else{if(!o&&(J=e.dom.get("__mce"))){if(E){J.setAttribute("id",E)}else{J.removeAttribute("id")}H=O.createRange();H.setStartBefore(J);H.setEndBefore(J);U.setRng(H)}}}function g(t){return t.nodeType==1&&/^(H[1-6]|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CODE|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|NOFRAMES|MENU|ISINDEX|SAMP)$/.test(t.nodeName)}function f(t){return w.getParent(t,function(z){return g(z)})}function j(t){t=t.innerHTML;t=t.replace(/<img|hr|table/g,"d");t=t.replace(/<[^>]+>/g,"");return t.replace(/[ \t\r\n]+/g,"")==""}function p(Q){var R=e.getDoc(),I=e.selection.getSel(),J=e.selection.getRng(),S=R.body;var M,N,K,P,O,B,z,C,E,t,G,T,A,D,L,F,H;if(a.isOldWebKit){return true}M=R.createRange();M.setStart(I.anchorNode,I.anchorOffset);M.collapse(true);N=R.createRange();N.setStart(I.focusNode,I.focusOffset);N.collapse(true);K=M.compareBoundaryPoints(M.START_TO_END,N)<0;P=K?I.anchorNode:I.focusNode;O=K?I.anchorOffset:I.focusOffset;B=K?I.focusNode:I.anchorNode;z=K?I.focusOffset:I.anchorOffset;P=P.nodeName=="BODY"?P.firstChild:P;B=B.nodeName=="BODY"?B.firstChild:B;C=f(P);E=f(B);t=C?C.nodeName:q.element;if(w.getParent(C,function(U){return/OL|UL/.test(U.nodeName)})){return true}if(C&&(C.nodeName=="CAPTION"||/absolute|relative|static/gi.test(C.style.position))){t=q.element;C=null}if(E&&(E.nodeName=="CAPTION"||/absolute|relative|static/gi.test(E.style.position))){t=q.element;E=null}if(/(TD|TABLE|TH|CAPTION)/.test(t)||(C&&t=="DIV"&&/left|right/gi.test(C.style.cssFloat))){t=q.element;C=E=null}G=(C&&C.nodeName==t)?C.cloneNode(0):R.createElement(t);T=(E&&E.nodeName==t)?E.cloneNode(0):R.createElement(t);T.id="";if(/^(H[1-6])$/.test(t)&&P.nodeValue&&O==P.nodeValue.length){T=R.createElement(q.element)}L=A=P;do{if(L==S||L.nodeType==9||g(L)||/(TD|TABLE|TH|CAPTION)/.test(L.nodeName)){break}A=L}while((L=L.previousSibling?L.previousSibling:L.parentNode));L=D=B;do{if(L==S||L.nodeType==9||g(L)||/(TD|TABLE|TH|CAPTION)/.test(L.nodeName)){break}D=L}while((L=L.nextSibling?L.nextSibling:L.parentNode));if(A.nodeName==t){M.setStart(A,0)}else{M.setStartBefore(A)}M.setEnd(P,O);G.appendChild(M.cloneContents());N.setEndAfter(D);N.setStart(B,z);T.appendChild(N.cloneContents());J=R.createRange();if(!A.previousSibling&&A.parentNode.nodeName==t){J.setStartBefore(A.parentNode)}else{if(M.startContainer.nodeName==t&&M.startOffset==0){J.setStartBefore(M.startContainer)}else{J.setStart(M.startContainer,M.startOffset)}}if(!D.nextSibling&&D.parentNode.nodeName==t){J.setEndAfter(D.parentNode)}else{J.setEnd(N.endContainer,N.endOffset)}J.deleteContents();if(G.firstChild&&G.firstChild.nodeName==t){G.innerHTML=G.firstChild.innerHTML}if(T.firstChild&&T.firstChild.nodeName==t){T.innerHTML=T.firstChild.innerHTML}if(j(G)){G.innerHTML=x?" <br />":"<br />"}if(j(T)){T.innerHTML=x?" <br />":"<br />"}if(x){J.insertNode(G);J.insertNode(T)}else{J.insertNode(T);J.insertNode(G)}T.normalize();G.normalize();J=R.createRange();J.selectNodeContents(T);J.collapse(1);I.removeAllRanges();I.addRange(J);vp=c(e.getWin());F=e.dom.getPos(T).y;H=T.clientHeight;if(F<vp.y||F+H>vp.y+vp.h){e.getWin().scrollTo(0,F<vp.y?F:F-vp.h+25)}return false}function i(A,G){var D=e.getBody(),z,B=e.selection,t=B.getRng(),C=t.startContainer,z,E,F;if(C&&g(C)&&!/^(TD|TH)$/.test(C.nodeName)&&G){if(C.childNodes.length==0||(C.childNodes.length==1&&C.firstChild.nodeName=="BR")){z=C;while((z=z.previousSibling)&&!g(z)){}if(z){if(C!=D.firstChild){E=e.getDoc().createTreeWalker(z,NodeFilter.SHOW_TEXT,null,false);while(F=E.nextNode()){z=F}t=e.getDoc().createRange();t.setStart(z,z.nodeValue?z.nodeValue.length:0);t.setEnd(z,z.nodeValue?z.nodeValue.length:0);B.getSel().removeAllRanges();B.getSel().addRange(t);C.parentNode.removeChild(C)}return y.cancel(A)}}}function H(I){var J;I=I.target;if(I&&I.parentNode&&I.nodeName=="BR"&&(z=f(I))){J=I.previousSibling;y.remove(D,"DOMNodeInserted",H);if(J&&J.nodeType==3&&/\s+$/.test(J.nodeValue)){return}if(I.previousSibling||I.nextSibling){I.parentNode.removeChild(I)}}}y._add(D,"DOMNodeInserted",H);window.setTimeout(function(){y._remove(D,"DOMNodeInserted",H)},1)}}})(punymce);(function(a){a.plugins.Emoticons=function(f){var l=a.Event,j,i,d,c,n,k,m,e;j=a.each;i=a.extend;d=a.isIE;c=a.isGecko;m=a.DOM;this.settings=n=i({emoticons:{happy:[":)","=)"],unhappy:[":|","=|"],sad:[":(","=("],grin:[":D","=D"],surprised:[":o",":O","=o","=O"],wink:[";)"],halfhappy:[":/","=/"],tounge:[":P",":p","=P","=p"],lol:[],mad:[],rolleyes:[],cool:[]},row_length:4,trans_img:a.baseURL+"plugins/emoticons/img/trans.gif",skip_css:0,auto_convert:1},f.settings.emoticons);if(!n.skip_css){m.loadCSS(a.baseURL+"/plugins/emoticons/css/editor.css")}k="";j(n.emoticons,function(h){j(h,function(o){if(k.length!=0){k+="|"}k+=o.replace(/([^a-zA-Z0-9])/g,"\\$1")})});k=new RegExp(k,"g");i(f.commands,{mceEmoticons:function(B,A,y){var q,C=this,h=f.settings.id,o=m.getPos(y.target),z,w;if(f.hideMenu){return f.hideMenu()}function x(p){f.hideMenu=null;l.remove(document,"click",x);l.remove(f.getDoc(),"click",x);m.get(h+"_memoticons").style.display="none";return 1}q=m.get(h+"_memoticons");if(!q){q=m.get(h+"_t");q=m.add(document.body,"div",{id:h+"_memoticons","class":"punymce_emoticons punymce"});q=m.add(q,"table",{"class":"punymce"});q=m.add(q,"tbody");z=n.row_length;j(n.emoticons,function(t,p){if(z==n.row_length){r=m.add(q,"tr");z=0}z++;l.add(m.add(m.add(r,"td"),"a",{href:"#","class":"emoticon "+p}),"mousedown",function(u){x.call(C);f.selection.setNode(f.dom.create("img",{title:t[0]||p,src:n.trans_img,"class":"emoticon "+p}));return l.cancel(u)})})}l.add(document,"click",x,C);l.add(f.getDoc(),"click",x,C);f.hideMenu=x;s=m.get(h+"_memoticons").style;s.left=o.x+"px";s.top=(o.y+y.target.clientHeight+2)+"px";s.display="block"}});function g(h){var o;j(n.emoticons,function(q,p){j(q,function(t){if(t==h){o=p;return false}});return !o});return o}f.onPreProcess.add(function(q,t){var p=t.node.getElementsByTagName("img"),h=[];j(p,function(o){h.push(o)});j(h,function(u){var o=f.dom.getAttr(u,"class");if(o&&o.indexOf("emoticon")!=-1){u.parentNode.replaceChild(f.getDoc().createTextNode(u.getAttribute("title")),u)}})});f.onSetContent.add(function(p,q){var h=[];e=q.content.replace(/(<\/?[^>]+>|:\/\/)/g,function(o){return o.replace(k,function(t){var u=g(t);if(u){h.push(t);return"¤"+h.length+"¤"}return t})});e=e.replace(k,function(o){return'<img src="'+n.trans_img+'" title="'+o+'" class="emoticon '+g(o)+'" />'});e=e.replace(/¤([^¤]+)¤/g,function(t,o){return h[parseInt(o)-1]});q.content=e});f.onInit.add(function(){var h=f.dom;if(!n.skip_css){h.loadCSS(a.baseURL+"/plugins/emoticons/css/content.css")}l.add(f.getDoc(),"controlselect",function(o){if(h.getAttr(o.target,"class").indexOf("emoticon")!=-1){return l.cancel(o)}});if(c){l.add(f.getDoc(),"mousedown",function(o){if(h.getAttr(o.target,"class").indexOf("emoticon")!=-1){f.getDoc().execCommand("enableObjectResizing",false,false);return l.cancel(o)}else{f.getDoc().execCommand("enableObjectResizing",false,true)}});l.add(f.getDoc(),"keydown",function(u){var y=f.selection,v=y.getSel(),w=f.getDoc(),o=y.getRng(),x,p,q,t;x=o.startContainer;p=o.startOffset;if(x.nodeType==1){return}if(x){if(u.keyCode==39&&p==x.nodeValue.length){q=x.nextSibling;if(q&&q.nodeName=="IMG"){q=q.nextSibling;o=w.createRange();o.setStart(q,0);o.setEnd(q,0);v.removeAllRanges();v.addRange(o);return l.cancel(u)}}if(u.keyCode==37&&p==0){q=x.previousSibling;if(q&&q.nodeName=="IMG"){q=q.previousSibling;t=q.nodeValue.length;o=w.createRange();o.setStart(q,t);o.setEnd(q,t);v.removeAllRanges();v.addRange(o);return l.cancel(u)}}}})}l.add(f.getDoc(),"keypress",function(u){var q,y,p,x,w=f.getDoc(),v=f.selection,z=v.getSel(),o=v.getRng();function t(D){var C,B,A;if(!d){C=o.startContainer;B=o.startOffset;A=o.endOffset;if(B>0&&C.nodeType==3){return C.nodeValue.substring(Math.max(0,B+D),A)}}else{o=o.duplicate();o.moveStart("character",D);return o.text}}if(a.isOldWebKit||!n.auto_convert){return true}if(/(ttp|ftp):/i.test(t(-4))){return}p=t(-1);q=p+String.fromCharCode(u.charCode||u.keyCode);k.lastIndex=0;if(!p||!k.test(q)||x=="/"){return}if(y=g(q)){if(!d){o.setStart(o.startContainer,o.startOffset-1);z.removeAllRanges();z.addRange(o)}else{o=f.selection.getRng();o.moveStart("character",-1);o.select()}f.selection.setNode(h.create("img",{id:"emoticon",title:q,src:n.trans_img,"class":"emoticon "+y}));q=h.get("emoticon");h.setAttr(q,"id","");f.selection.select(q);f.selection.collapse(0);return l.cancel(u)}})});i(f.tools,{emoticons:{cmd:"mceEmoticons",title:a.I18n.emoticons}})};a.extend(a.I18n,{emoticons:"Insert emoticon"})})(punymce);(function(a){a.plugins.EditSource=function(d){var e=a.DOM,h=a.extend,g=a.each,f=a.isWebKit;var c=0;if(!d.settings.editsource||d.settings.editsource.skip_css){e.loadCSS(a.baseURL+"/plugins/editsource/css/editor.css")}d.onBeforeGetContent.add(function(i,j){if(j.save&&c){i.setContent(e.get(i.settings.id+"_editsourcearea").value,{load:true})}});h(d.commands,{mceEditSource:function(t,q,o){var k,j=d.getIfr(),i=d.settings.id,p=d.width,l=d.height,n,m=e.get(i+"_editsource");if(!c){e.addClass(m,"active");g(e.select("li",i+"_c"),function(u){if(u!=m){e.addClass(u,"disabled")}});k=e.add(j.parentNode,"textarea",{id:i+"_editsourcearea","class":"editsource",style:"width:"+p+"px;height:"+l+"px;"});k.value=d.getContent({save:true});k.focus();if(!f){e.add(j.parentNode,"div",{id:i+"_edspacer","class":"spacer",style:"width:"+p+"px;height:"+l+"px;"});j.style.display="none"}c=1;return false}c=0;e.removeClass(m,"active");if(!f){j.style.display="block";k=e.get(i+"_edspacer");k.parentNode.removeChild(k)}k=e.get(i+"_editsourcearea");d.setContent(k.value,{load:true});k.parentNode.removeChild(k);g(e.select("li",i+"_c"),function(u){e.removeClass(u,"disabled")});return false}});h(d.tools,{editsource:{cmd:"mceEditSource",title:a.I18n.editsource}})};a.extend(a.I18n,{editsource:"Edit HTML source"})})(punymce);(function(a){a.plugins.Image=function(c){var d=a.I18n;if(!c.settings.image||c.settings.image.skip_css){a.DOM.loadCSS(a.baseURL+"/plugins/image/css/editor.css")}a.extend(c.commands,{mceInsertImage:function(i,h,k){var g,j=c.selection.getNode();g=prompt(d.entersrc,j.nodeName=="IMG"?c.dom.getAttr(j,"src"):"");if(g){c.selection.setNode(c.dom.create("img",{src:g}))}}});a.extend(c.tools,{image:{cmd:"mceInsertImage",title:d.insertimage}})};a.extend(a.I18n,{insertimage:"Insert image",entersrc:"Enter the URL of the image"})})(punymce);(function(a){a.plugins.Link=function(c){var d=a.I18n;if(!c.settings.link||c.settings.link.skip_css){a.DOM.loadCSS(a.baseURL+"/plugins/link/css/editor.css")}a.extend(c.commands,{mceInsertLink:function(i,h,k){var g,j=c.selection.getNode();g=prompt(d.enterhref,j.nodeName=="A"?c.dom.getAttr(j,"href"):"");if(g){if(c.selection.isCollapsed()){c.selection.setContent('<a href="'+g+'">'+g+"</a>")}else{c.execCommand("CreateLink",0,g)}}}});a.extend(c.tools,{link:{cmd:"mceInsertLink",title:d.link},unlink:{cmd:"Unlink",title:d.unlink}})};a.extend(a.I18n,{link:"Insert link",unlink:"Unlink",enterhref:"Enter the URL of the link"})})(punymce);(function(a){a.plugins.TextColor=function(e){var d="000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF";var g=a.DOM,c=a.Event,h=a.each,i=a.extend,f;if(!e.settings.textcolor||e.settings.textcolor.skip_css){g.loadCSS(a.baseURL+"/plugins/textcolor/css/editor.css")}f=i({colors:d},e.settings.textcolor);i(e.commands,{mceColor:function(y,x,q){var l,z=this,j=e.settings.id,k=g.getPos(q.target),w,m;if(e.hideMenu){return e.hideMenu()}function o(n){e.hideMenu=null;c.remove(document,"click",o);c.remove(e.getDoc(),"click",o);g.get(j+"_mcolor").style.display="none";return 1}l=g.get(j+"_mcolor");if(!l){l=g.get(j+"_t");l=g.add(document.body,"div",{id:j+"_mcolor","class":"punymce_color punymce"});l=g.add(l,"table",{"class":"punymce"});l=g.add(l,"tbody");w=8;h(f.colors.split(","),function(n){if(w==8){r=g.add(l,"tr");w=0}w++;c.add(g.add(g.add(r,"td"),"a",{href:"#",style:"background:#"+n}),"mousedown",function(p){o.call(z);e.execCommand("forecolor",0,"#"+n);return c.cancel(p)})})}c.add(document,"click",o,z);c.add(e.getDoc(),"click",o,z);e.hideMenu=o;f=g.get(j+"_mcolor").style;f.left=k.x+"px";f.top=(k.y+q.target.clientHeight+2)+"px";f.display="block"}});i(e.tools,{textcolor:{cmd:"mceColor",title:a.I18n.textcolor}})};a.extend(a.I18n,{textcolor:"Text color"})})(punymce);(function(c){var a=c.Event;function d(i,g){var h,f;h=g.parentNode;f=g.nextSibling;if(f){h.insertBefore(i,f)}else{h.appendChild(i)}return i}function e(h,j,i){var f,g=h.getDoc().createTreeWalker(j,NodeFilter.SHOW_TEXT,null,false);if(i){return g.nextNode()}while(f=g.nextNode()){j=f}return j}c.plugins.Paste=function(g){var j=c.DOM,h;g.onPaste=new c.Dispatcher(g);function i(w){var x,u=[],n,t,m=g.selection,l,o,q,k,p;g.getWin().focus();if(h){r=g.selection.getRng();r.moveToBookmark(h);r.select()}x=w.split(/\r?\n/);if(x.length>1){w="";c.each(x,function(v){w+="<p>"+v+"</p>"});if(!c.isIE){g.execCommand("Delete");m.setContent('<span id="marker"></span>');n=g.dom.getParent(g.dom.get("marker").parentNode,function(v){u.push(v);if(/^(p|h[1-6]|div)$/i.test(v.nodeName)){return true}});if(n){g.onPaste.dispatch({text:w});l=o="";for(q=0;q<u.length;q++){l+="</"+u[q].nodeName.toLowerCase()+">"}for(q=u.length-1;q>=0;q--){o+="<"+u[q].nodeName.toLowerCase()+">"}w=l+w+o+'<span id="_caret">&nbsp;</span>';g.getBody().innerHTML=g.getBody().innerHTML.replace(/<span id=\"marker\"><\/span>/gi,w);t=g.dom.get("_caret");if(!c.isGecko){t.scrollIntoView()}k=g.getDoc().createRange();k.setStartBefore(t);k.setEndAfter(t);m.setRng(k);g.execCommand("Delete");return}else{p=g.dom.get("marker");p.parentNode.removeChild(p)}}}g.selection.setContent(w);g.onPaste.dispatch({text:w})}function f(q){var t,l,o=g.selection,m=o.getSel(),p,k=g.getBody();t=g.dom.add(k,"div",{id:"_mcePaste",style:"position:absolute;left:-10000px;top:"+k.scrollTop},"&nbsp;");p=o.getRng();t=t.firstChild;l=g.getDoc().createRange();l.setStart(t,0);l.setEnd(t,1);m.removeAllRanges();m.addRange(l);window.setTimeout(function(){var v=g.dom.get("_mcePaste"),u;u=v.innerHTML;v.parentNode.removeChild(v);if(p){o.setRng(p)}i(u.replace(/[\r\n]/g,"").replace(/<(\/p|br\s*\/?)>/g,"\n").replace(/<!--.*?-->/g,"").replace(/<[^>]+>/g,""))},0)}g.onInit.add(function(){if(c.isOpera){return}if(/Firefox\/2/.test(navigator.userAgent)){a.add(g.getDoc(),"keydown",function(k){if(((k.metaKey||k.ctrlKey)&&k.keyCode==86)||(k.shiftKey&&k.keyCode==45)){if(c.isIE){h=g.selection.getRng().getBookmark()}f(k)}},this)}else{a.add(c.isIE?g.getBody():g.getDoc(),"paste",function(k){var l;if(g.getWin().clipboardData){i(g.getWin().clipboardData.getData("Text"));return a.cancel(k)}if(k.clipboardData){i(k.clipboardData.getData("text/plain"));return a.cancel(k)}f(k)})}})}})(punymce);(function(a){a.plugins.BBCode=function(c){c.onGetContent.add(function(d,e){if(e.format=="bbcode"||e.save){a.each([[/<a href=\"(.*?)\".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"],[/<font.*?color=\"([^\"]+)\".*?>(.*?)<\/font>/gi,"[color=$1]$2[/color]"],[/<img.*?src=\"([^\"]+)\".*?\/>/gi,"[img]$1[/img]"],[/<(br\s*\/)>/gi,"\n"],[/<(\/?)(strong|b)[^>]*>/gi,"[$1b]"],[/<(\/?)(em|i)[^>]*>/gi,"[$1i]"],[/<(\/?)u[^>]*>/gi,"[$1u]"],[/<(\/?)(code|pre)[^>]*>/gi,"[$1code]"],[/<(\/?)(span.*?class=\"quote\")[^>]*>(.*?)<\/span>/gi,"[$1quote]$3[/quote]"],[/<p>/gi,""],[/<\/p>/gi,"\n"],[/&quot;/gi,'"'],[/&lt;/gi,"<"],[/&gt;/gi,">"],[/&amp;/gi,"&"],[/<[^>]+>/gi,""]],function(f){e.content=e.content.replace(f[0],f[1])})}});c.onSetContent.add(function(d,e){if(e.format=="bbcode"||e.load){a.each([[/\n/gi,"<br />"],[/\[(\/?)b\]/gi,"<$1strong>"],[/\[(\/?)i\]/gi,"<$1em>"],[/\[(\/?)u\]/gi,"<$1u>"],[/\[(\/?)code\]/gi,"<$1pre>"],[/\[url\](.*?)\[\/url\]/gi,'<a href="$1">$1</a>'],[/\[url=([^\]]+)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'],[/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'],[/\[color=(.*?)\](.*?)\[\/color\]/gi,'<font color="$1">$2</font>'],[/\[quote.*?\](.*?)\[\/quote\]/gi,'<span class="quote">$1</span>']],function(f){e.content=e.content.replace(f[0],f[1])})}})}})(punymce);(function(a){a.plugins.Entities=function(f){var k,d,j="",c={},g,e,h;k=f.settings;k.entities="named";h=k.entity_list;if(!h){h="160,nbsp,161,iexcl,162,cent,163,pound,164,curren,165,yen,166,brvbar,167,sect,168,uml,169,copy,170,ordf,171,laquo,172,not,173,shy,174,reg,175,macr,176,deg,177,plusmn,178,sup2,179,sup3,180,acute,181,micro,182,para,183,middot,184,cedil,185,sup1,186,ordm,187,raquo,188,frac14,189,frac12,190,frac34,191,iquest,192,Agrave,193,Aacute,194,Acirc,195,Atilde,196,Auml,197,Aring,198,AElig,199,Ccedil,200,Egrave,201,Eacute,202,Ecirc,203,Euml,204,Igrave,205,Iacute,206,Icirc,207,Iuml,208,ETH,209,Ntilde,210,Ograve,211,Oacute,212,Ocirc,213,Otilde,214,Ouml,215,times,216,Oslash,217,Ugrave,218,Uacute,219,Ucirc,220,Uuml,221,Yacute,222,THORN,223,szlig,224,agrave,225,aacute,226,acirc,227,atilde,228,auml,229,aring,230,aelig,231,ccedil,232,egrave,233,eacute,234,ecirc,235,euml,236,igrave,237,iacute,238,icirc,239,iuml,240,eth,241,ntilde,242,ograve,243,oacute,244,ocirc,245,otilde,246,ouml,247,divide,248,oslash,249,ugrave,250,uacute,251,ucirc,252,uuml,253,yacute,254,thorn,255,yuml,402,fnof,913,Alpha,914,Beta,915,Gamma,916,Delta,917,Epsilon,918,Zeta,919,Eta,920,Theta,921,Iota,922,Kappa,923,Lambda,924,Mu,925,Nu,926,Xi,927,Omicron,928,Pi,929,Rho,931,Sigma,932,Tau,933,Upsilon,934,Phi,935,Chi,936,Psi,937,Omega,945,alpha,946,beta,947,gamma,948,delta,949,epsilon,950,zeta,951,eta,952,theta,953,iota,954,kappa,955,lambda,956,mu,957,nu,958,xi,959,omicron,960,pi,961,rho,962,sigmaf,963,sigma,964,tau,965,upsilon,966,phi,967,chi,968,psi,969,omega,977,thetasym,978,upsih,982,piv,8226,bull,8230,hellip,8242,prime,8243,Prime,8254,oline,8260,frasl,8472,weierp,8465,image,8476,real,8482,trade,8501,alefsym,8592,larr,8593,uarr,8594,rarr,8595,darr,8596,harr,8629,crarr,8656,lArr,8657,uArr,8658,rArr,8659,dArr,8660,hArr,8704,forall,8706,part,8707,exist,8709,empty,8711,nabla,8712,isin,8713,notin,8715,ni,8719,prod,8721,sum,8722,minus,8727,lowast,8730,radic,8733,prop,8734,infin,8736,ang,8743,and,8744,or,8745,cap,8746,cup,8747,int,8756,there4,8764,sim,8773,cong,8776,asymp,8800,ne,8801,equiv,8804,le,8805,ge,8834,sub,8835,sup,8836,nsub,8838,sube,8839,supe,8853,oplus,8855,otimes,8869,perp,8901,sdot,8968,lceil,8969,rceil,8970,lfloor,8971,rfloor,9001,lang,9002,rang,9674,loz,9824,spades,9827,clubs,9829,hearts,9830,diams,338,OElig,339,oelig,352,Scaron,353,scaron,376,Yuml,710,circ,732,tilde,8194,ensp,8195,emsp,8201,thinsp,8204,zwnj,8205,zwj,8206,lrm,8207,rlm,8211,ndash,8212,mdash,8216,lsquo,8217,rsquo,8218,sbquo,8220,ldquo,8221,rdquo,8222,bdquo,8224,dagger,8225,Dagger,8240,permil,8249,lsaquo,8250,rsaquo,8364,euro"}d=h.split(",");for(g=0;g<d.length;g+=2){c[String.fromCharCode(d[g])]=d[g+1];e=parseInt(d[g]).toString(16);j+="\\u"+"0000".substring(e.length)+e}j=new RegExp("["+j+"]","g");f.onGetContent.add(function(i,l){if(l.format=="html"){l.content=l.content.replace(j,function(m){var n;if(n=c[m]){m="&"+n+";"}return m})}})}})(punymce);(function(a){a.plugins.Protect=function(c){var f=[],d,e;e=c.settings.protect||{};if(!e.list){e.list=[/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g]}c.onSetContent.add(function(g,h){a.each(e.list,function(i){h.content=h.content.replace(i,function(j){f.push(j);return"<!-- pro:"+(f.length-1)+" -->"})})});c.onGetContent.add(function(g,h){h.content=h.content.replace(/<!-- pro:([0-9]+) -->/g,function(j,i){return f[parseInt(i)]})})}})(punymce);(function(a){function c(g,e){var f,d;f=e.parentNode;d=e.nextSibling;if(d){f.insertBefore(g,d)}else{f.appendChild(g)}return g}a.plugins.TabFocus=function(e){var d=a.Event,f=a.DOM;e.onInit.add(function(){var h,g,i;i=c(f.create("a",{href:"#"}),f.get(e.settings.id+"_c"));d.add(i,"focus",function(j){e.getWin().focus()});d.add(e.getDoc(),"keydown",function(j){if(j.keyCode==9){return d.cancel(j)}});d.add(e.getDoc(),"keydown",function(j){if(j.keyCode==9){window.focus();f.get(e.settings.tabfocus_id).focus()}})})}})(punymce);(function(a){a.plugins.Safari2x=function(h){var k=a.each,l=a.Event,g,f,j;if(!a.isOldWebKit){return}h.selection.getRng=function(){var n=this,o=n.getSel(),w=h.getDoc(),q,u,v,p;if(o.anchorNode){q=w.createRange();try{u=w.createRange();u.setStart(o.anchorNode,o.anchorOffset);u.collapse(1);v=w.createRange();v.setStart(o.focusNode,o.focusOffset);v.collapse(1);p=u.compareBoundaryPoints(u.START_TO_END,v)<0;q.setStart(p?o.anchorNode:o.focusNode,p?o.anchorOffset:o.focusOffset);q.setEnd(p?o.focusNode:o.anchorNode,p?o.focusOffset:o.anchorOffset)}catch(m){}}return q};f=h.selection.setContent;h.selection.setContent=function(o,n){var p=this.getRng();try{f.call(this,o,n)}catch(m){b=h.dom.create("body");b.innerHTML=o;k(b.childNodes,function(q){p.insertNode(q.cloneNode(true))})}};j=h.selection.collapse;h.selection.collapse=function(m){try{j.call(this,m)}catch(n){}};h.onInit.add(function(){a.DOM.get(h.settings.id+"_r").style.display="none"});h.onPreInit.add(function(){l.add(h.getDoc(),"click",function(m){if(m.target.nodeName=="A"){h.selection.select(m.target);return l.cancel(m)}});l.add(h.getDoc(),"keydown",function(q){var m=h.selection,v,t,p,u;if(q.charCode>32||q.keyCode==13){v=h.dom.getParent(m.getNode(),function(o){return o.nodeName=="LI"});if(v){t=m.getRng().startOffset;if(q.keyCode==13){if(!v.hasChildNodes()){if(!v.nextSibling||v.nextSibling.nodeName!="LI"){p=h.dom.getParent(m.getNode(),function(o){return/(UL|OL)/.test(o.nodeName)});v.parentNode.removeChild(v);m.select(p.nextSibling);return}return l.cancel(q)}u=h.getDoc().createTextNode("\u00a0");v.appendChild(u);window.setTimeout(function(){var o=m.getNode();if(o.firstChild&&o.firstChild.nodeValue.charAt(0)=="\u00a0"){o.removeChild(o.firstChild);m.select(o)}},1)}else{u=String.fromCharCode(q.charCode);if(!/^\w$/.test(u)){return}m.setContent(u);p=m.getRng();m=m.getSel();v=m.anchorNode;if(v.nodeName=="LI"){m.setBaseAndExtent(v,1,v,1)}else{v=v.nextSibling;m.setBaseAndExtent(v,1,v,1)}return l.cancel(q)}}}})});function c(t,m){var q=h.getDoc(),p,o;m=m||{};q.execCommand("FontName",false,"_tmp");k(h.dom.select("span"),function(n){if(n.style.fontFamily=="_tmp"){p=d(n,t,m);if(!o){o=p}}});p=p.firstChild;h.selection.getSel().setBaseAndExtent(o,0,p,p.nodeValue.length)}function i(p){var o=h.selection,m;o.setContent("<"+p+'><li id="_tmp"></li></'+p+">");m=h.dom.get("_tmp");m.id="";o.select(m);o.collapse(1)}function e(m){return h.dom.getParent(m,function(o){return/^(H[1-6]|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CODE|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|DIR|FIELDSET|NOSCRIPT|NOFRAMES|MENU|ISINDEX|SAMP)$/.test(o.nodeName)})}function d(p,t,m){var q=h.getDoc(),o;m=m||{};o=q.createElement(t);k(p.attributes,function(u){if(u.specified&&u.nodeValue){o.setAttribute(u.nodeName,u.nodeValue)}});k(m,function(u,n){o.setAttribute(n,u)});k(p.childNodes,function(u){o.appendChild(u.cloneNode(true))});p.parentNode.replaceChild(o,p);return o}a.extend(h.commands,{IncreaseFontSize:function(){var n=h.getDoc(),m=parseInt(n.queryCommandValue("FontSize"));n.execCommand("FontSize",false,(m+1)+"px")},DecreaseFontSize:function(){var n=h.getDoc(),m=parseInt(n.queryCommandValue("FontSize"));if(m>0){n.execCommand("FontSize",false,(m-1)+"px")}},Strikethrough:function(){c("strike")},CreateLink:function(n,m){c("a",{href:m,mce_href:m})},Unlink:function(){var m=h.selection;m.setContent(m.getContent().replace(/(<a[^>]+>|<\/a>)/,""))},RemoveFormat:function(){var m=h.selection;m.setContent(m.getContent().replace(/(<(span|b|i|strong|em|strike) [^>]+>|<(span|b|i|strong|em|strike)>|<\/(span|b|i|strong|em|strike)>|)/g,""))},FormatBlock:function(o,m){var p=h.selection,q;q=e(h.selection.getNode());if(q){r=d(q,m.replace(/<|>/g,""))}p.select(r);p.collapse(1)},InsertUnorderedList:function(){i("ul")},InsertOrderedList:function(){i("ol")},Indent:function(){var o=e(h.selection.getNode()),m;if(o){m=parseInt(o.style.paddingLeft)||0;o.style.paddingLeft=(m+10)+"px"}},Outdent:function(){var o=e(h.selection.getNode()),m;if(o){m=parseInt(o.style.paddingLeft)||0;if(m>=10){o.style.paddingLeft=(m-10)+"px"}}}})}})(punymce);