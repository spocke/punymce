(function(p){var n,f,s,j,b,i,t,d,k;var a,h,g,q,m,r,l;l=navigator.userAgent;p.isOpera=q=window.opera&&opera.buildNumber;p.isWebKit=m=/WebKit/.test(l);p.isOldWebKit=r=m&&!window.getSelection().getRangeAt;p.isIE=h=!m&&!q&&(/MSIE/gi).test(l)&&(/Explorer/gi).test(navigator.appName);p.isGecko=g=!m&&/Gecko/.test(l);p.plugins={};function e(v,u){v=typeof(v);if(!u){return v!="undefined"}return v==u}function c(w,u,v){var x;if(!w){return 0}v=!v?w:v;if(e(w.length)){for(x=0;x<w.length;x++){if(u.call(v,w[x],x,w)===false){return 0}}}else{for(x in w){if(w.hasOwnProperty(x)){if(u.call(v,w[x],x,w)===false){return 0}}}}return 1}function o(v,u){c(u,function(w,x){v[x]=w});return v}o(p,{is:e,each:c,extend:o});p.I18n=k={bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",underline:"Underline (Ctrl+U)",strike:"Striketrough",ul:"Insert unordered list",ol:"Insert ordered list",indent:"Indent",outdent:"Outdent",left:"Align left",center:"Align center",right:"Align right",style:"Font style",removeformat:"Remove format",increasefontsize:"Increase text size",decreasefontsize:"Decrease text size"};p.DOMUtils=n=function(v){this.files=[];try{v.execCommand("BackgroundImageCache",0,1)}catch(u){}o(this,{get:function(w){return w&&(!w.nodeType&&!w.location?v.getElementById(w):w)},add:function(A,B,w,y){var x=this,z;z=v.createElement(B);c(w,function(C,D){x.setAttr(z,D,C)});if(y){if(y.nodeType){z.appendChild(y)}else{z.innerHTML=y}}return A?A.appendChild(z):z},create:function(y,w,x){return this.add(0,y,w,x)},setAttr:function(x,y,w){x=this.get(x);if(!x){return 0}if(y=="style"){x.setAttribute("mce_style",w);x.style.cssText=w}if(y=="class"){x.className=w}if(w!=null&&w!=""){x.setAttribute(y,""+w)}else{x.removeAttribute(y)}return 1},getAttr:function(y,z,x){var w;y=this.get(y);if(!y){return false}if(!e(x)){x=""}if(/^(src|href|style)$/.test(z)){w=this.getAttr(y,"mce_"+z);if(w){return w}}w=y.getAttribute(z,2);if(z=="class"&&!w){w=y.className}if(z=="style"&&!w){w=y.style.cssText}else{if(!w){w=y.attributes[z];w=w&&e(w.nodeValue)?w.nodeValue:w}}if(m&&z=="class"&&w){w=w.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}return(w&&w!="")?""+w:x},select:function(w,z,x){var y=[];z=this.get(z);z=!z?v:z;c(w.split(","),function(A){c(z.getElementsByTagName(A),function(B){if(!x||x(B)){y.push(B)}})});return y},getPos:function(C,B){var w=0,x=0,z,y,A;C=this.get(C);if(p.isIE&&C){y=C.getBoundingClientRect();A=document;C=A.compatMode=="CSS1Compat"?A.documentElement:A.body;return{x:y.left+(C.scrollLeft||0),y:y.top+(C.scrollTop||0)}}while(C&&C!=B){w+=C.offsetLeft||0;x+=C.offsetTop||0;C=C.offsetParent}return{x:w,y:x}},loadCSS:function(w){var x=this;if(w){c(w.split(","),function(z){var y=-1;c(x.files,function(B,A){if(B==z){y=A;return false}});if(y!=-1){return}x.files.push(z);if(!v.createStyleSheet){x.add(x.select("head")[0],"link",{rel:"stylesheet",href:z})}else{v.createStyleSheet(z)}})}},addClass:function(x,z,w){var y;x=this.get(x);if(!x){return 0}y=this.removeClass(x,z);return x.className=w?z+(y!=""?(" "+y):""):(y!=""?(y+" "):"")+z},removeClass:function(w,x){w=this.get(w);if(!w){return 0}x=w.className.replace(new RegExp("(^|\\s+)"+x+"(\\s+|$)","g")," ");return w.className=x!=" "?x:""},hasClass:function(x,w){x=this.get(x);return new RegExp("\\b"+w+"\\b","g").test(x.className)},getParent:function(y,x,w){while(y){if(y==w){return null}if(x(y)){return y}y=y.parentNode}return null},keep:function(w){if(g){w=w.replace(/<(\/?)strong>|<strong( [^>]+)>/gi,"<$1b$2>");w=w.replace(/<(\/?)em>|<em( [^>]+)>/gi,"<$1i$2>");w=w.replace(/<(\/?)del|<del( [^>]+)>/gi,"<$1strike$2>")}w=w.replace(/ (src|href|style)=\"([^\"]+)\"/gi,' $1="$2" mce_$1="$2"');return w}})};p.DOM=a=new n(document);p.Event=t={events:[],inits:[],unloads:[],add:function(z,A,y,x){var u,v=this,w=v.events;z=a.get(z);u=function(B){B=B||window.event;if(B&&!B.target&&h){B.target=B.srcElement}if(!x){return y(B)}return y.call(x,B)};if(A=="unload"){v.unloads.push(u);return u}if(A=="init"){if(v._init){u()}else{v.inits.push(u)}return u}w.push({obj:z,name:A,func:y,cfunc:u,scope:x});v._add(z,A,u);if(h&&w.length==1){t._add(window,"unload",v._unload,t)}return u},remove:function(x,y,w){var v=this,u=v.events;x=a.get(x);c(u,function(A,z){if(A.obj==x&&A.name==y&&(!w||A.func==w)){u.splice(z,1);v._remove(x,y,A.cfunc);return false}})},cancel:function(u){this.stop(u);return this.prevent(u)},stop:function(u){if(u.stopPropagation){u.stopPropagation()}else{u.cancelBubble=true}return false},prevent:function(u){if(u.preventDefault){u.preventDefault()}else{u.returnValue=false}return false},_unload:function(){var u=t;c(u.events,function(v){u._remove(v.obj,v.name,v.cfunc)});u._remove(window,"unload",u._unload);u.events=[];c(u.unloads,function(v){v()})},_add:function(v,w,u){if(v.attachEvent){v.attachEvent("on"+w,u)}else{if(v.addEventListener){v.addEventListener(w,u,false)}else{v["on"+w]=u}}},_remove:function(v,w,u){if(v.detachEvent){v.detachEvent("on"+w,u)}else{if(v.removeEventListener){v.removeEventListener(w,u,false)}else{v["on"+w]=null}}},_pageInit:function(){var u=t;u._remove(window,"DOMContentLoaded",u._pageInit);u._init=true;c(u.inits,function(v){v()});u.inits=[]},_wait:function(){var u;if(h&&document.location.protocol!="https:"){document.write("<script id=__ie_onload defer src=javascript:void(0)><\/script>");a.get("__ie_onload").onreadystatechange=function(){if(this.readyState=="complete"){t._pageInit();a.get("__ie_onload").onreadystatechange=null}}}else{t._add(window,"DOMContentLoaded",t._pageInit,t);if(h||m){u=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(u);t._pageInit()}},10)}}}};p.Dispatcher=i=function(u){var v=[];if(!u){u=this}o(this,{add:function(w,x){v.push({cb:w,scope:!x?u:x});return w},remove:function(w){c(v,function(y,x){if(w==y.cb){v.splice(x,1)}return false});return w},dispatch:function(){var x,w=arguments;c(v,function(y){return x=y.cb.apply(y.scope,w)});return x}})};p.Editor=j=function(B){var y,z,w=this;if(!p.baseURL){c(a.select("script"),function(C){if(/puny_mce/g.test(""+C.src)){p.baseURL=C.src.replace(/^(.+)\/puny_mce.+$/,"$1/")}})}this.settings=y=o({content_css:p.baseURL+"/css/content.css",editor_css:p.baseURL+"/css/editor.css",width:0,height:0,min_width:260,min_height:50,max_width:800,max_height:600,entities:"raw",spellcheck:0,resize:true,plugins:"",styles:[{title:"H1",cls:"h1",cmd:"FormatBlock",val:"<h1>"},{title:"H2",cls:"h2",cmd:"FormatBlock",val:"<h2>"},{title:"H3",cls:"h3",cmd:"FormatBlock",val:"<h3>"},{title:"Pre",cls:"pre",cmd:"FormatBlock",val:"<pre>"},{title:"Times",cls:"times",cmd:"FontName",val:"Times"},{title:"Arial",cls:"arial",cmd:"FontName",val:"Arial"},{title:"Courier",cls:"courier",cmd:"FontName",val:"Courier"}],toolbar:"bold,italic,underline,strike,increasefontsize,decreasefontsize,ul,ol,indent,outdent,left,center,right,style,removeformat"},B);w.tools={bold:{cmd:"Bold",title:k.bold},italic:{cmd:"Italic",title:k.italic},underline:{cmd:"Underline",title:k.underline},strike:{cmd:"Strikethrough",title:k.strike},ul:{cmd:"InsertUnorderedList",title:k.ul},ol:{cmd:"InsertOrderedList",title:k.ol},indent:{cmd:"Indent",title:k.indent},outdent:{cmd:"Outdent",title:k.outdent},left:{cmd:"JustifyLeft",title:k.left},center:{cmd:"JustifyCenter",title:k.center},right:{cmd:"JustifyRight",title:k.right},style:{cmd:"mceStyle",title:k.style},removeformat:{cmd:"RemoveFormat",title:k.removeformat},increasefontsize:{cmd:"IncreaseFontSize",title:k.increasefontsize},decreasefontsize:{cmd:"DecreaseFontSize",title:k.decreasefontsize}};a.loadCSS(y.editor_css);this.commands={mceStyle:function(J,I,H){var E,K=this,L=K.settings,C=L.id,D=a.getPos(H.target),F;if(K.hideMenu){return K.hideMenu()}function G(M){K.hideMenu=null;t.remove(document,"click",G);t.remove(K.getDoc(),"click",G);a.get(C+"_mstyle").style.display="none"}E=a.get(C+"_mstyle");if(!E){E=a.get(C+"_t");E=a.add(document.body,"div",{id:C+"_mstyle","class":"punymce_style punymce"});c(L.styles,function(M){t.add(a.add(E,"a",{href:"#","class":M.cls},M.title),"mousedown",function(N){G.call(K);K.execCommand(M.cmd,M.ui,M.val);if(q){K.getIfr().focus()}return t.cancel(N)})})}K.hideMenu=G;t.add(document,"click",G,K);t.add(K.getDoc(),"click",G,K);L=E.style;L.left=D.x+"px";L.top=(D.y+H.target.clientHeight+2)+"px";L.display="block"},FormatBlock:function(D,C,E){if(g&&/<(div|blockquote|code|dt|dd|dl|samp)>/gi.test(C)){C=C.replace(/[^a-z]/gi,"")}w.getDoc().execCommand("FormatBlock",0,C)},CreateLink:function(E,D){var F=w.dom,C="javascript:mox();";w.getDoc().execCommand("CreateLink",0,C);c(F.select("A"),function(G){if(F.getAttr(G,"href")==C){F.setAttr(G,"href",D);F.setAttr(G,"mce_href",D)}})},mceFontSizeDelta:function(E,D){var I=w.getDoc(),C,H,F,G=w.selection;C=parseInt(I.queryCommandValue("FontSize")||3);if(m){c([10,13,16,18,24,32,48],function(K,J){if(C==K){C=J+1;return false}})}if(C+D<=1){return}I.execCommand("FontSize",false,C+D)},IncreaseFontSize:function(){w.execCommand("mceFontSizeDelta",0,1)},DecreaseFontSize:function(){w.execCommand("mceFontSizeDelta",0,-1)},Indent:function(D,C,E){w.getDoc().execCommand("Indent",0,0);if(h){w.dom.getParent(w.selection.getNode(),function(F){if(F.nodeName=="BLOCKQUOTE"){F.dir=F.style.marginRight=""}})}},mceSetClass:function(D,C,F){var E=w.selection;if(e(C,"string")){C={element:"span","class":C}}if(E.isCollapsed()){w.dom.setAttr(E.getNode(),"class",C["class"])}else{E.setContent("<"+C.element+' class="'+C["class"]+'">'+E.getContent()+"</"+C.element+">")}},RemoveFormat:function(D,C,F){var E=w.selection;w.getDoc().execCommand("RemoveFormat",D,C);if(h){C=E.getContent();C=C.replace(/ (class|style)=\"[^\"]+\"/g,"");C=C.replace(/<\/?(font|strong|em|b|i|u|strike)>/g,"");C=C.replace(/<(font|strong|em|b|i|u|strike) [^>]+>/g,"");E.setContent(C)}}};function x(F){var G,E,C,D;G=a.get(y.id+"_c");C=G.clientWidth-2;D=G.clientHeight-2;E=a.get(y.id+"_p");E.style.width=C+"px";E.style.height=D+"px";G.style.display="none";E.style.display="block";w.resize={x:F.screenX,y:F.screenY,w:C,h:D};t.add(document,"mousemove",v,this);t.add(document,"mouseup",A,this);w.onResizeStart.dispatch(w,F,C,D)}function v(G){var E=w.resize,F,C,D;E.dx=G.screenX-E.x;E.dy=G.screenY-E.y;C=Math.max(y.min_width,E.w+E.dx);D=Math.max(y.min_height,E.h+E.dy);C=Math.min(y.max_width,C);D=Math.min(y.max_height,D);F=a.get(y.id+"_p");F.style.width=C+"px";F.style.height=D+"px";return t.cancel(G)}function A(D){var C=w.resize;t.remove(document,"mousemove",v,this);t.remove(document,"mouseup",A,this);a.get(y.id+"_c").style.display="";a.get(y.id+"_p").style.display="none";w.resizeBy(C.dx,C.dy);w.onResizeEnd.dispatch(w,D,C.dx,C.dy)}function u(){var C=a.get(y.id),D=w.getDoc();if(g){w.getDoc().designMode="On"}D.open();D.write('<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body id="punymce"></body></html>');D.close();w.dom=z=new n(w.getDoc());z.loadCSS(y.content_css);w.onPreInit.dispatch(w);if(!y.spellcheck){w.getBody().spellcheck=0}t.add(w.getDoc(),"mouseup",w.nodeChanged,w);t.add(w.getDoc(),"keyup",w.nodeChanged,w);t.add(g?w.getDoc():w.getWin(),"focus",function(F){var E;if((E=p.focusEditor)!=null){E.onBlur.dispatch(E,w)}w.onFocus.dispatch(w,E);p.focusEditor=w},this);if(!h){w.getDoc().designMode="On"}else{w.getBody().contentEditable=true}w.setContent(e(C.value)?C.value:C.innerHTML,{load:true});a.get(y.id+"_c").style.display=w.orgDisplay;a.get(y.id).style.display="none";w.onInit.dispatch(w)}o(this,{serializer:new d(w),selection:new b(w),plugins:[]});c(["onPreInit","onInit","onFocus","onBlur","onResizeStart","onResizeEnd","onPreProcess","onPostProcess","onSetContent","onBeforeGetContent","onGetContent","onNodeChange"],function(C){w[C]=new i(w)});o(this,{init:function(){var H=a.get(y.id),J=H.parentNode,L,F,K,I,D,C,G,E=["bold","italic","underline","left","center","right"];c(y.plugins.split(","),function(M){if(M){w.plugins.push(new p.plugins[M](w))}});w.onNodeChange.add(function(){c(E,function(O){var N;try{N=w.getDoc().queryCommandState(w.tools[O].cmd)?a.addClass:a.removeClass;N.call(a,y.id+"_"+O,"active")}catch(M){}})});if(y.entities=="numeric"){w.onGetContent.add(function(M,N){if(N.format=="html"){N.content=N.content.replace(/[\u007E-\uFFFF]/g,function(O){return"&#"+O.charCodeAt(0)+";"})}})}L=!y.width?H.offsetWidth:y.width;F=!y.height?H.offsetHeight:y.height;w.orgDisplay=H.style.display;H.style.display="none";if(H.form){G=H.form;w._submit=G.submit;G.submit=function(){var N=a.get(y.id),M=N.form;w.save();M.submit=w._submit;M.submit()};t.add(0,"unload",function(){var M=a.get(y.id).form;w._submit=w.submit=null});t.add(G,"submit",w.save,w)}K='<div id="'+y.id+'_w" class="punymce"><table id="'+y.id+'_c" class="punymce"><tr class="mceToolbar">';K+='<td id="'+y.id+'_t"></td></tr><tr class="mceBody"><td></div><div id="'+y.id+'_b" class="mceBody">';if(y.resize){K+='<div id="'+y.id+'_r" class="mceResize"></div>'}K+="</td></tr></table>";K+='<div id="'+y.id+'_p" class="mcePlaceholder"></div></div>';if(!H.insertAdjacentHTML){C=H.ownerDocument.createRange();C.setStartBefore(H);J.insertBefore(C.createContextualFragment(K),H)}else{H.insertAdjacentHTML("beforeBegin",K)}D=a.get(y.id+"_t");I=a.add(D,"ul",{id:y.id+"_tb","class":"punymce"});c(y.toolbar.split(","),function(M){var N=w.tools[M];D=a.add(a.add(I,"li",{id:y.id+"_"+M,"class":M}),"a",{href:"javascript:void(0);","class":M,title:N.title,tabIndex:-1,onmousedown:"return false;"});t.add(D,"click",function(O){if(!a.hasClass(O.target.parentNode,"disabled")){w.execCommand(N.cmd,0,0,O)}return t.cancel(O)})});D=a.get(y.id+"_b");D=a.add(D,"iframe",{id:y.id+"_f",src:'javascript:""',frameBorder:"0","class":"punymce",style:"width:"+L+"px;height:"+F+"px"});w.resizeTo(L,F);if(m){t.add(D,"load",u,w);D.src=p.baseURL+"blank.htm"}else{u()}if(y.resize){t.add(y.id+"_r","mousedown",function(M){return x(M,y.id)},this)}I=G=H=D=null},getSize:function(){var C=a.get(y.id+"_f");return{w:C.clientWidth,h:C.clientHeight}},resizeTo:function(C,E){var D=a.get(y.id+"_f").style;C=Math.max(y.min_width,C);E=Math.max(y.min_height,E);C=Math.min(y.max_width,C);E=Math.min(y.max_height,E);w.width=C;w.height=E;D.width=C+"px";D.height=E+"px"},resizeBy:function(C,D){var E=w.getSize();w.resizeTo(E.w+C,E.h+D)},show:function(){a.get(y.id+"_w").style.display="block";a.get(y.id).style.display="none";w.load()},hide:function(){if(h){w.execCommand("SelectAll")}a.get(y.id+"_w").style.display="none";a.get(y.id).style.display=w.orgDisplay;w.save()},load:function(){var C=a.get(y.id);w.setContent(e(C.value)?C.value:C.innerHTML,{load:true})},save:function(){var D=a.get(y.id),C=w.getContent({save:true});if(/TEXTAREA|INPUT/.test(D.nodeName)){D.value=C}else{D.innerHTML=C}},setUseCSS:function(C){var E=w.getDoc(),D;try{E.execCommand("styleWithCSS",0,false)}catch(D){try{E.execCommand("useCSS",0,true)}catch(D){}}},execCommand:function(H,E,D,G){var C=w.commands,F;w.getWin().focus();w.setUseCSS(0);if(C[H]){F=C[H].call(w,E,D,G)}else{F=w.getDoc().execCommand(H,E,D)}if(F!==false){w.nodeChanged()}},getContent:function(D){var C;D=D||{};D.format=D.format||"html";w.onBeforeGetContent.dispatch(this,D);C=w.serializer.serialize(w.getBody(),D);C=C.replace(/^\s*|\s*$/g,"");D.content=C;w.onGetContent.dispatch(this,D);return D.content},setContent:function(C,D){D=D||{};D.content=C;w.onSetContent.dispatch(this,D);C=D.content;C=a.keep(C);w.getBody().innerHTML=C;if(D.format!="raw"){w.setContent(C=w.getContent(D),{format:"raw"})}else{w.getBody().innerHTML=C}return C},getIfr:function(){return a.get(y.id+"_f")},getWin:function(){return w.getIfr().contentWindow},getDoc:function(){return w.getWin().document},getBody:function(){return w.getDoc().body},nodeChanged:function(){w.setUseCSS(0);w.onNodeChange.dispatch(w,w.selection.getNode())}});t.add(window,"init",w.init,this)};p.Selection=b=function(u){var v=this;o(v,{getContent:function(z){var w,x=v.getRng(),y=document.createElement("body");z=z||{};if(v.isCollapsed()){return""}if(x.cloneContents){y.appendChild(x.cloneContents())}else{if(e(x.item)||e(x.htmlText)){y.innerHTML=x.item?x.item(0).outerHTML:x.htmlText}else{y.innerHTML=x.toString()}}if(z.format!="raw"){z.content=w;u.serializer.serialize(y,z);z.content=z.content.replace(/^\s*|\s*$/g,"");u.onGetContent.dispatch(w,z);w=z.content}else{w=y.innerHTML}return w},getText:function(){var x=v.getRng(),w=v.getSel();if(r){return w}return v.isCollapsed()?"":x.text||w.toString()},setContent:function(y,A){var z=v.getRng(),w,B,z,x;A=A||{format:"raw"};y=a.keep(y);if(A.format!="raw"){A.content=y;y=u.onSetContent.dispatch(this,A);y=A.content;w=u.dom.create("body");w.innerHTML=y}if(z.insertNode){z.deleteContents();z.insertNode(z.createContextualFragment(y+'<span id="__caret">_</span>'));B=u.dom.get("__caret");z=u.getDoc().createRange();z.setStartBefore(B);z.setEndBefore(B);x=v.getSel();x.removeAllRanges();x.addRange(z);B.parentNode.removeChild(B)}else{if(z.pasteHTML){z.pasteHTML(y)}else{z.item(0).outerHTML=y}}},select:function(A,z){var y=v.getRng(),x=v.getSel();if(y.moveToElementText){try{y.moveToElementText(A);y.select()}catch(w){}}else{if(x.addRange){z?y.selectNodeContents(A):y.selectNode(A);x.removeAllRanges();x.addRange(y)}else{x.setBaseAndExtent(A,0,A,1)}}return A},isCollapsed:function(){var w=v.getRng();if(w.item){return false}return w.boundingWidth==0||v.getSel().isCollapsed},collapse:function(w){var y=v.getRng(),x=v.getSel();if(y.select){y.collapse(w);y.select()}else{if(w){x.collapseToStart()}else{x.collapseToEnd()}}},getSel:function(){var x=u.getWin();return x.getSelection?x.getSelection():u.getDoc().selection},getRng:function(){var w=v.getSel(),C=u.getDoc(),y,A,B,x;if(!w){return null}try{return w.rangeCount>0?w.getRangeAt(0):(w.createRange?w.createRange():null)}catch(z){return C.body.createTextRange()}},setRng:function(x){var w=v.getSel();w.removeAllRanges();w.addRange(x)},setNode:function(w){v.setContent(u.dom.create("div",null,w).innerHTML)},getNode:function(){var x=v.getRng(),w=v.getSel(),y;if(!h){if(x){y=x.commonAncestorContainer;if(!x.collapsed){if(x.startContainer==x.endContainer){if(x.startOffset-x.endOffset<2){if(x.startContainer.hasChildNodes()){y=x.startContainer.childNodes[x.startOffset]}}}}}return a.getParent(y,function(z){return z.nodeType==1})}return x.item?x.item(0):x.parentElement()}})};p.Serializer=d=function(v){var x,y=0,z;function w(){var C=document.implementation;if(!C||!C.createDocument){try{return new ActiveXObject("MSXML2.DOMDocument")}catch(B){}try{return new ActiveXObject("Microsoft.XmlDom")}catch(B){}}else{return C.createDocument("","",null)}}x=w();this.settings=z=o({valid_nodes:0,invalid_nodes:/(BODY)/,valid_attrs:0,node_filter:0,root_node:0,pi:0,invalid_attrs:/(^mce_|^_moz_|^contenteditable$)/,closed:/(BR|HR|INPUT|META|IMG)/},v.settings.serializer);function A(C){var B=[];C.cloneNode(false).outerHTML.replace(/([a-z0-9\-_]+)=/gi,function(E,D){B.push({specified:1,nodeName:D})});return B}function u(D,G){var H,B,I,F,E,J,C,L,K;if((!z.valid_nodes||z.valid_nodes.test(D.nodeName))&&(!z.invalid_nodes||!z.invalid_nodes.test(D.nodeName))&&(!z.node_filter||z.node_filter(D,G))){switch(D.nodeType){case 1:if(h){if(D.mce_serialized==y){return}D.mce_serialized=y}H=D.hasChildNodes();B=x.createElement(D.nodeName.toLowerCase());C=h?A(D):D.attributes;for(F=C.length-1;F>-1;F--){L=C[F];if(L.specified){J=L.nodeName.toLowerCase();if(z.invalid_attrs&&z.invalid_attrs.test(J)){continue}if(z.valid_attrs&&!z.valid_attrs.test(J)){continue}K=a.getAttr(D,J);if(K!==""){B.setAttribute(J,K)}}}if(!H&&!z.closed.test(D.nodeName)){B.appendChild(x.createTextNode(""))}G=G.appendChild(B);break;case 3:return G.appendChild(x.createTextNode(D.nodeValue));case 8:return G.appendChild(x.createComment(D.nodeValue))}}else{if(D.nodeType==1){H=D.hasChildNodes()}}if(H){I=D.firstChild;while(I){u(I,G);I=I.nextSibling}}}o(this,{serialize:function(D,C){var B;y=""+(parseInt(y)+1);if(x.firstChild){x.removeChild(x.firstChild)}D=C.node=D.cloneNode(1);v.onPreProcess.dispatch(this,C);u(D,x.appendChild(x.createElement("html")));B=x.xml||new XMLSerializer().serializeToString(x);if(!z.pi){B=B.replace(/<\?[^?]+\?>/g,"")}if(!z.root_node){B=B.replace(/<html>|<\/html>/g,"")}C.content=B;v.onPostProcess.dispatch(this,C);return C.content}})};t._wait();window.punymce=p})({});